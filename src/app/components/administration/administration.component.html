<div class="form-container">

    <h2>Application Administration</h2>

    <form [formGroup]="adminForm" class="form-grid">

        <div class="form-group full-width">
            <label class="col-label">Action</label>
            <div class="radio-group">
                <button type="button" class="pill-btn" [class.active]="adminForm.get('action')?.value === 'Stop'"
                    (click)="adminForm.patchValue({action: 'Stop'})">
                    Stop
                </button>
                <button type="button" class="pill-btn"
                    [class.active]="adminForm.get('action')?.value === 'Stop Immediately'"
                    (click)="adminForm.patchValue({action: 'Stop Immediately'})">
                    Stop Immediately
                </button>
                <button type="button" class="pill-btn" [class.active]="adminForm.get('action')?.value === 'Start'"
                    (click)="adminForm.patchValue({action: 'Start'})">
                    Start
                </button>
                <button type="button" class="pill-btn" [class.active]="adminForm.get('action')?.value === 'Restart'"
                    (click)="adminForm.patchValue({action: 'Restart'})">
                    Restart
                </button>
                <button type="button" class="pill-btn" [class.active]="adminForm.get('action')?.value === 'Uninstall'"
                    (click)="adminForm.patchValue({action: 'Uninstall'})">
                    Uninstall
                </button>
                <button type="button" class="pill-btn" [class.active]="adminForm.get('action')?.value === 'Remove'"
                    (click)="adminForm.patchValue({action: 'Remove'})">
                    Remove
                </button>
            </div>
        </div>

        <div class="form-group">
            <label class="col-label">Environment <span class="required">*</span></label>
            <div class="col-input">
                <select formControlName="environment"
                    [class.input-error]="isSubmitted && adminForm.get('environment')?.invalid">
                    <option value="">Select environment</option>
                    <option value="SYST">SYST</option>
                    <option value="UAT">UAT</option>
                    <option value="PROD">PROD</option>
                </select>
                @if (isSubmitted && adminForm.get('environment')?.invalid) {
                <div class="error-msg">Environment is required</div>
                }
            </div>
        </div>

        <div class="form-group">
            <label class="col-label">Domain <span class="required">*</span></label>
            <div class="col-input">
                <select formControlName="domain" [class.input-error]="isSubmitted && adminForm.get('domain')?.invalid">
                    <option value="">Select domain</option>
                    <option value="S1FD11">S1FD11</option>
                    <option value="S1FD12">S1FD12</option>
                </select>
                @if (isSubmitted && adminForm.get('domain')?.invalid) {
                <div class="error-msg">Domain is required</div>
                }
            </div>
        </div>

        <div class="form-group">
            <label class="col-label">Admin Target <span class="required">*</span></label>
            <div class="col-input">
                <select formControlName="adminTarget"
                    [class.input-error]="isSubmitted && adminForm.get('adminTarget')?.invalid">
                    <option value="">Select admin target</option>
                    <option value="Target1">Target1</option>
                    <option value="Target2">Target2</option>
                </select>
                @if (isSubmitted && adminForm.get('adminTarget')?.invalid) {
                <div class="error-msg">Admin Target is required</div>
                }
            </div>
        </div>

        <div class="form-group">
            <label class="col-label">Time (optional)</label>
            <div class="col-input">
                <div class="flex-input">
                    <input type="text" mwlFlatpickr formControlName="adminTime" [enableTime]="true"
                        dateFormat="Y-m-d H:i" altFormat="d/m/Y H:i" [altInput]="true" placeholder="dd/mm/yyyy --:--"
                        class="date-picker-input">
                    <button type="button" class="icon-btn" (click)="setToNow()" title="Set to Current Time">
                        <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" fill="none"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M23 4v6h-6"></path>
                            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <div class="form-actions full-width">
            <button type="button" class="deploy-btn" (click)="onSubmit()">
                Submit
                <svg class="btn-icon" viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2"
                    fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
            </button>
        </div>

    </form>

    @if (showConfirmation) {
    <div class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Administration Action</h3>
            </div>
            <div class="modal-body">
                <p class="modal-intro">Are you sure you want to <strong>{{ adminForm.get('action')?.value | lowercase
                        }}</strong> this service?
                </p>
                <div class="summary-grid">
                    <div class="summary-item">
                        <span class="label">Action:</span>
                        <span class="value">{{ adminForm.get('action')?.value }}</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Environment:</span>
                        <span class="value">{{ adminForm.get('environment')?.value }}</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Domain:</span>
                        <span class="value">{{ adminForm.get('domain')?.value }}</span>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" (click)="cancelAction()">Cancel</button>
                <button class="btn-primary" (click)="confirmAction()">Confirm</button>
            </div>
        </div>
    </div>
    }

    <div class="toast-notification" [class.show]="toastVisible" [class.error]="toastType === 'error'">
        <div class="toast-icon">
            @if (toastType === 'success') {
            <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2" fill="none"
                stroke-linecap="round" stroke-linejoin="round">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            } @else {
            <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="3" fill="none"
                stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12" y2="17"></line>
            </svg>
            }
        </div>
        <span class="toast-message">{{ toastMessage }}</span>
        <button class="toast-close" (click)="closeToast()">
            <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none"
                stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
    </div>

</div>